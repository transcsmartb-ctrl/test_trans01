{
  "openapi": "3.0.3",
  "info": {
    "title": "OAuth Token Endpoint (TOKEN-001/002)",
    "description": "OAuth 2.0 token issuance - client_credentials + authorization_code grants",
    "version": "1.0.0"
  },
  "servers": [{ "url": "https://your-domain.com/oauth" }],
  "paths": {
    "/token": {
      "post": {
        "summary": "TOKEN-001/002: Get access token",
        "description": "OAuth 2.0 token endpoint - client_credentials (M2M) or authorization_code (user)",
        "parameters": [
          {
            "name": "Content-Type",
            "in": "header",
            "required": true,
            "schema": { "type": "string", "enum": ["application/x-www-form-urlencoded"] }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "oneOf": [
                  {
                    "properties": {
                      "grant_type": { "type": "string", "enum": ["client_credentials"] },
                      "client_id": { "type": "string", "example": "testsmart" },
                      "client_secret": { "type": "string" },
                      "scope": { "type": "string", "default": "login" }
                    },
                    "required": ["grant_type", "client_id", "client_secret"]
                  },
                  {
                    "properties": {
                      "grant_type": { "type": "string", "enum": ["authorization_code"] },
                      "client_id": { "type": "string", "example": "testsmart" },
                      "client_secret": { "type": "string" },
                      "code": { "type": "string", "example": "efr8" },
                      "redirect_uri": { "type": "string", "format": "uri" }
                    },
                    "required": ["grant_type", "client_id", "client_secret", "code"]
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Token issued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                },
                "example": {
                  "access_token": "5bd97253e4a24fd9911bad",
                  "refresh_token": "5bd97253e4a24fd991red",
                  "token_type": "Bearer",
                  "expires_in": 3599,
                  "scope": "login"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request (grant_type, client_id)",
            "content": {
              "application/json": {
                "example": { "error": "invalid_request", "error_description": "Missing grant_type" }
              }
            }
          },
          "401": { "description": "Invalid client credentials" }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "TokenResponse": {
        "type": "object",
        "properties": {
          "access_token": { "type": "string" },
          "refresh_token": { "type": "string" },
          "token_type": { "type": "string", "example": "Bearer" },
          "expires_in": { "type": "integer", "example": 3599 },
          "scope": { "type": "string", "example": "login" }
        },
        "required": ["access_token", "token_type", "expires_in"]
      }
    }
  }
}

